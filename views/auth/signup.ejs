<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign Up - Ella Rises</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-color: #f9afb1;
        --secondary-color: #ce325b;
        --accent-color: #e8a87c;
        --dark-text: #2c2c2c;
        --light-bg: #faf8f5;
        --white: #ffffff;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #ffd8d1, #f9afb1);
        min-height: 100vh;
        display: flex;
        align-items: flex-start;
        justify-content: center;
        padding: 40px 20px;
      }

      .signup-wrapper {
        display: flex;
        gap: 30px;
        max-width: 1200px;
        width: 100%;
        align-items: flex-start;
      }

      .signup-container {
        background: white;
        padding: 50px;
        border-radius: 20px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        flex: 1;
        max-width: 700px;
      }

      .image-collage {
        flex: 0 0 400px;
        height: fit-content;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .collage-image {
        width: 100%;
        height: 500px;
        object-fit: cover;
        border-radius: 20px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      }

      @media (max-width: 992px) {
        .signup-wrapper {
          flex-direction: column;
        }

        .image-collage {
          flex: 1;
          width: 100%;
          max-width: 600px;
          order: -1;
        }

        .collage-image {
          height: 350px;
        }
      }

      @media (max-width: 576px) {
        .collage-image {
          height: 250px;
        }
      }

      .signup-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .signup-header img {
        width: 180px;
        height: auto;
        margin-bottom: 20px;
      }

      .signup-header h1 {
        font-size: 2rem;
        font-weight: 700;
        color: var(--dark-text);
        margin-bottom: 10px;
      }

      .signup-header p {
        color: var(--secondary-color);
        margin: 0;
      }

      .form-label {
        font-weight: 600;
        color: var(--dark-text);
        margin-bottom: 8px;
      }

      .form-control {
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        padding: 12px 15px;
        transition: all 0.3s ease;
      }

      .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(212, 101, 76, 0.15);
      }

      .form-control.is-invalid {
        border-color: #dc3545;
        box-shadow: 0 0 0 0.15rem rgba(220, 53, 69, 0.2);
      }

      .form-control.is-valid {
        border-color: #198754;
        box-shadow: 0 0 0 0.15rem rgba(25, 135, 84, 0.2);
      }

      .btn-signup {
        background: linear-gradient(135deg, #ffd8d1, #f9afb1);
        border: none;
        padding: 14px;
        font-weight: 600;
        border-radius: 10px;
        transition: all 0.3s ease;
        color: white;
      }

      .btn-signup:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(212, 101, 76, 0.3);
        color: white;
      }

      .alert {
        border-radius: 10px;
        border: none;
      }

      .back-link {
        text-align: center;
        margin-top: 20px;
      }

      .back-link a {
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      .back-link a:hover {
        color: var(--secondary-color);
      }
    </style>
  </head>
  <body>
    <div class="signup-wrapper">
      <div class="image-collage">
        <img
          src="/signup/DSC_5359.jpg"
          alt="Ella Rises Workshop"
          class="collage-image"
        />
        <img
          src="/signup/ER_STEM_Workshop.jpg"
          alt="Ella Rises Workshop"
          class="collage-image"
        />
      </div>

      <div class="signup-container">
        <div class="signup-header">
          <img src="https://intex-user-photos.s3.us-east-2.amazonaws.com/static/Ella_Rises_Logo.avif" alt="Ella Rises Logo" />
          <h1>Create Account</h1>
          <p>Join Ella Rises</p>
        </div>

        <% if (error) { %>
        <div class="alert alert-danger">
          <i class="bi bi-exclamation-triangle-fill"></i> <%= error %>
        </div>
        <% } %>

        <form id="signupForm" action="/auth/signup" method="POST" novalidate>
          <!-- Guardian Information -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Parent/Guardian First Name</label>
              <input
                name="participantGuardianFirstName"
                type="text"
                class="form-control"
                placeholder="Enter First Name"
                autofocus
              />
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Parent/Guardian Last Name</label>
              <input
                name="participantGuardianLastName"
                type="text"
                class="form-control"
                placeholder="Enter Last Name"
              />
            </div>
          </div>

          <!-- Participant Information -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Participant First Name</label>
              <input
                name="participantFirstName"
                type="text"
                class="form-control"
                placeholder="Enter First Name"
                required
              />
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Participant Last Name</label>
              <input
                name="participantLastName"
                type="text"
                class="form-control"
                placeholder="Enter Last Name"
                required
              />
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label">Participant Email</label>
            <input
              name="participantEmail"
              type="email"
              class="form-control"
              placeholder="Enter email"
            />
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Participant Birth Date</label>
              <input
                name="participantDOB"
                type="date"
                class="form-control"
                required
              />
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Participant Phone Number</label>
              <input
                name="participantPhone"
                type="tel"
                class="form-control"
                placeholder="Enter Phone Number"
                inputmode="tel"
                pattern="^\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}$"
                title="Use a 10-digit phone number (e.g., 555-555-5555)"
                required
              />
            </div>
          </div>

          <!-- Address Information -->
          <div class="row">
            <div class="col-md-5 mb-3">
              <label class="form-label">City</label>
              <input
                name="participantCity"
                type="text"
                class="form-control"
                placeholder="Enter City"
                required
              />
            </div>
            <div class="col-md-4 mb-3">
              <label class="form-label">State</label>
              <select name="participantState" class="form-control" required>
                <option value="">Select State</option>
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <option value="AZ">Arizona</option>
                <option value="AR">Arkansas</option>
                <option value="CA">California</option>
                <option value="CO">Colorado</option>
                <option value="CT">Connecticut</option>
                <option value="DE">Delaware</option>
                <option value="FL">Florida</option>
                <option value="GA">Georgia</option>
                <option value="HI">Hawaii</option>
                <option value="ID">Idaho</option>
                <option value="IL">Illinois</option>
                <option value="IN">Indiana</option>
                <option value="IA">Iowa</option>
                <option value="KS">Kansas</option>
                <option value="KY">Kentucky</option>
                <option value="LA">Louisiana</option>
                <option value="ME">Maine</option>
                <option value="MD">Maryland</option>
                <option value="MA">Massachusetts</option>
                <option value="MI">Michigan</option>
                <option value="MN">Minnesota</option>
                <option value="MS">Mississippi</option>
                <option value="MO">Missouri</option>
                <option value="MT">Montana</option>
                <option value="NE">Nebraska</option>
                <option value="NV">Nevada</option>
                <option value="NH">New Hampshire</option>
                <option value="NJ">New Jersey</option>
                <option value="NM">New Mexico</option>
                <option value="NY">New York</option>
                <option value="NC">North Carolina</option>
                <option value="ND">North Dakota</option>
                <option value="OH">Ohio</option>
                <option value="OK">Oklahoma</option>
                <option value="OR">Oregon</option>
                <option value="PA">Pennsylvania</option>
                <option value="RI">Rhode Island</option>
                <option value="SC">South Carolina</option>
                <option value="SD">South Dakota</option>
                <option value="TN">Tennessee</option>
                <option value="TX">Texas</option>
                <option value="UT">Utah</option>
                <option value="VT">Vermont</option>
                <option value="VA">Virginia</option>
                <option value="WA">Washington</option>
                <option value="WV">West Virginia</option>
                <option value="WI">Wisconsin</option>
                <option value="WY">Wyoming</option>
                <option value="OTHER">Out of US</option>
              </select>
            </div>
            <div class="col-md-3 mb-3">
              <label class="form-label">Zip Code</label>
              <input
                name="participantZip"
                type="text"
                class="form-control"
                placeholder="Zip Code"
                required
              />
            </div>
          </div>

          <!-- Account Information -->
          <div class="mb-3">
            <label class="form-label">Username</label>
            <input
              name="username"
              type="text"
              class="form-control"
              placeholder="Choose a username"
              required
            />
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Password (8 Characters)</label>
              <input
                name="password"
                type="password"
                class="form-control"
                placeholder="Create a password"
                minlength="8"
                maxlength="128"
                required
              />
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Confirm Password (8 Characters)</label>
              <input
                name="confirmPassword"
                type="password"
                class="form-control"
                placeholder="Confirm password"
                minlength="8"
                maxlength="128"
                required
              />
            </div>
          </div>

          <button type="submit" class="btn btn-signup w-100">
            <i class="bi bi-check-circle-fill"></i> Sign Up
          </button>
        </form>

        <div class="text-center mt-3">
          <p class="mb-0">
            Already have an account?
            <a
              href="/auth/login"
              style="
                color: var(--primary-color);
                font-weight: 600;
                text-decoration: none;
              "
              >Login</a
            >
          </p>
        </div>

        <div class="back-link">
          <a href="/"> <i class="bi bi-arrow-left"></i> Back to Home </a>
        </div>
      </div>
    </div>

    <script>
      (() => {
        const form = document.getElementById("signupForm");
        if (!form) return;

        const controls = Array.from(form.querySelectorAll(".form-control"));
        const phoneField = form.querySelector('input[name="participantPhone"]');
        const passwordField = form.querySelector('input[name="password"]');
        const confirmPasswordField = form.querySelector(
          'input[name="confirmPassword"]'
        );
        const submitButton = form.querySelector('button[type="submit"]');

        const MIN_PASSWORD_LENGTH = 8;
        const phonePattern = /^\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}$/;

        const shouldValidate = (field) => {
          if (!field.required && field.value.trim() === "") {
            return false;
          }
          return true;
        };

        const updateFieldState = (field) => {
          if (!shouldValidate(field)) {
            field.classList.remove("is-invalid", "is-valid");
            return;
          }

          if (field.checkValidity()) {
            field.classList.add("is-valid");
            field.classList.remove("is-invalid");
          } else {
            field.classList.add("is-invalid");
            field.classList.remove("is-valid");
          }
        };

        const applyPhoneValidation = () => {
          if (!phoneField) return;
          const value = phoneField.value.trim();
          if (value === "") {
            phoneField.setCustomValidity("Please enter a phone number.");
          } else if (!phonePattern.test(value)) {
            phoneField.setCustomValidity("Enter a valid 10-digit phone number.");
          } else {
            phoneField.setCustomValidity("");
          }
          if (phoneField.dataset.touched === "true") {
            updateFieldState(phoneField);
          }
        };

        const enforcePasswordRules = () => {
          if (!passwordField || !confirmPasswordField || !submitButton) return;

          const passwordValue = passwordField.value;
          const confirmValue = confirmPasswordField.value;

          if (passwordValue && passwordValue.length < MIN_PASSWORD_LENGTH) {
            passwordField.setCustomValidity(
              `Password must be at least ${MIN_PASSWORD_LENGTH} characters long.`
            );
          } else {
            passwordField.setCustomValidity("");
          }

          if (
            confirmValue &&
            confirmValue.length >= MIN_PASSWORD_LENGTH &&
            confirmValue !== passwordValue
          ) {
            confirmPasswordField.setCustomValidity("Passwords must match.");
          } else if (
            confirmValue &&
            confirmValue.length < MIN_PASSWORD_LENGTH
          ) {
            confirmPasswordField.setCustomValidity(
              `Password must be at least ${MIN_PASSWORD_LENGTH} characters long.`
            );
          } else {
            confirmPasswordField.setCustomValidity("");
          }

          if (passwordField.dataset.touched === "true") {
            updateFieldState(passwordField);
          }
          if (confirmPasswordField.dataset.touched === "true") {
            updateFieldState(confirmPasswordField);
          }

          const passwordLongEnough =
            passwordValue.length >= MIN_PASSWORD_LENGTH;
          const confirmLongEnough =
            confirmValue.length >= MIN_PASSWORD_LENGTH;
          const passwordsMatch =
            passwordValue.length > 0 && passwordValue === confirmValue;
          submitButton.disabled = !(
            passwordLongEnough &&
            confirmLongEnough &&
            passwordsMatch
          );
        };

        if (submitButton) {
          submitButton.disabled = true;
        }

        controls.forEach((field) => {
          field.addEventListener("blur", () => {
            field.dataset.touched = "true";
            updateFieldState(field);
          });

          field.addEventListener("input", () => {
            if (field.dataset.touched === "true") {
              updateFieldState(field);
            }
          });
        });

        if (phoneField) {
          phoneField.addEventListener("input", applyPhoneValidation);
          phoneField.addEventListener("blur", applyPhoneValidation);
        }

        if (passwordField && confirmPasswordField) {
          passwordField.addEventListener("input", enforcePasswordRules);
          confirmPasswordField.addEventListener("input", enforcePasswordRules);
        }

        enforcePasswordRules();

        form.addEventListener("submit", (event) => {
          let formIsValid = true;

          controls.forEach((field) => {
            field.dataset.touched = "true";
            updateFieldState(field);
            if (!field.checkValidity()) {
              formIsValid = false;
            }
          });

          if (!formIsValid) {
            event.preventDefault();
            event.stopPropagation();
          }
        });

        if (phoneField) {
          applyPhoneValidation();
        }
      })();
    </script>
    <script src="/teapot.js"></script>
    <script src="/dom.js"></script>
    <script src="/chopped.js"></script>
    <script src="/redundancy.js"></script>
    <script src="/tableau.js"></script>
    <script src="/rick.js"></script>
  </body>
</html>
